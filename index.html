<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>SteadyCellPhenotype</title>
    <meta name="description" content="SteadyCellPhenotype">
    <meta name="author" content="Adam Knapp">
    <link rel="stylesheet" href="w3.css">
    <link rel="icon" href="images/icon.svg" type="image/svg+xml">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
    <header class="w3-container w3-us-blue">
      <img src="images/logo.svg" height="100px" style="margin-top: 2pt; margin-bottom: 2pt; max-width: 100%; max-height: 100px">
    </header>
    <div class="w3-bar w3-black">
      <a href="/" class="w3-bar-item w3-button w3-mobile">Home</a>
      <a href="/quickstart/" class="w3-bar-item w3-button w3-mobile">Quick Start</a>
      <a href="/docs/" class="w3-bar-item w3-button w3-mobile">Documentation</a>
      <a href="/source/" class="w3-bar-item w3-button w3-mobile">Source</a>
      <a href="/about/" class="w3-bar-item w3-button w3-mobile">About the Authors</a>
    </div>
    <div id="content" class="w3-container w3-mobile" style="margin:auto; max-width:1100px; text-align: justify; text-justify: inter-word;">
      <style>
        p.line_space
        {
            line-height: 1.7;
        }
        
        hr
        {
            display: block;
            margin-top: 0.5em;
            margin-bottom: 0.5em;
            margin-left: auto;
            margin-right: auto;
            border: 1px solid #79809B;
        }

        th, td {
            border: 1px solid #ccc;
        }
        
      </style>
      
      <!--- Documentation portion --->

      <article>

        <h1>Ternary networks in SteadyCellPhenotype</h1>
        
        <section>
          <p class="line_space"> Ternary models can represent biomolecular networks in a simple and
            intuitive manner by viewing the network in terms of a collection of logical rules. One
            can think of these models as an extension of Boolean models if simple logic is employed,
            but ternary models can also utilize more complicated rules and expressions. Each species
            in ternary network is represented by three states: 0, 1, and 2. Various assignments have
            been suggested for the states. For example, one possibility is to view 0 as
            <i>false/inactive</i>, 2 as <i>true/active</i>, and 1 as <i>unknown</i>, meaning that 1
            can be either true/active or false/inactive. Another possibility is to think of these
            numbers as concentration levels of various proteins: <i>low</i> (0),
            <i>normal</i> (1) and <i>high</i> (2). Regardless of the labeling, the interactions in
            the network can be translated into functions over the finite field on three elements and
            then used to perform simulations, computations of the attractors, and visualizations of
            these attractors and trajectories.
          </p>
          
          
          <p class="line_space">
            An example of a biological network (or a graph) is depicted in Figure 1 below.  This
            network is part of our previously published much larger network (see
            <cite><a href="https://doi.org/10.1371/journal.pcbi.1005352">
                doi:10.1371/journal.pcbi.1005352</a></cite>).  We have selected the <i>iron
              homeostasis pathway</i> to demonstrate the ideas and the terminology of this
            section. The underlying graph of this network is also a directed graph in the sense
            that each species is connected by an arc (edge) that has a direction, e.g., there is
            an arrow from TfR1 (transferrin receptor 1) to LIP (labile iron pool). In addition,
            in this network the graph is <i>signed</i> graph, that is, each connection from one
            species to the next is either positive (activation - blue arc with an arrow head) or
            negative (inhibition - orange arc with a hammer head).  We would like to note, that
            edges joining species do not have to be signed, but in most applications, majority
            of connections will be positive or negative.
          </p>
        </section>
        
        <center>
          <figure>
            <img src="images/Iron_core.svg" style="max-width: 90%;"/>
            <figcaption>
              <b>Figure 1 - Iron Homeostasis Pathway.</b> Portion of the graph from our published
              model <cite><a href="https://doi.org/10.1371/journal.pcbi.1005352">
                  doi:10.1371/journal.pcbi.1005352
              </a></cite>
            </figcaption>
          </figure>
        </center>

        <section>
          <h3> Local activation functions </h3>
          
          <p class="line_space">
            The next step in model building is to define a local activation function for each
            node in the network.  The value of each local activation function depends on its
            input nodes (species) and their current state.  This can be accomplished in
            multiple ways (i) using an analog to the Boolean formalism, (ii) tables and (iii)
            function over finite field on three elements. These are not the only
            possibilities. Here we describe the first possibility and just mention the second
            (our future editions will include generation of functions from tables directly).
            As for the third option and others, our browser based interface <i>
              SteadyCellPhenotype</i> is capable of reading any input function over a finite
            field on three elements, thus allowing the user to explore any type of ternary
            network.
          </p>
          
          <p class="line_space">
            A local activation function for a node \(v\) is often denoted in literature by
            \(f_v\). If the node \(v\) has multiple input nodes \( w_1, w_2, \dots, w_k \),
            then this function is written as \( f_v(w_1, w_2, \dots, w_k)\). Using this
            notation and Figure 1 activation function, for example, for LIP is then
            \(f_{LIP}(TfR1, Fpn, Ft)\). To make notations simpler, <i>SteadyCellPhenotype</i>
            allows user to replace bulky notation \(f_{LIP}(TfR1, Fpn, Ft)\) by simply typing
            \(LIP.\)
          </p>
          
          <center>
            <div class="w3-cell-row" style="width: 75%">
              <div class="w3-panel w3-mobile w3-border w3-light-grey w3-leftbar"
                   style="text-align: left">
                <h5> <i> SteadyCellPhenotype</i> syntax: </h5>
                <center>
                  <tt>
                    LIP = &lt;your function goes here&gt;
                  </tt>
                </center>
              </div>
            </div>
          </center>
          
          <p class="line_space">
            Now suppose, that a node in the network only has one input (e.g., IRP1 and IRP2 in
            Figure 1) and it is clear from the biological evidence if the regulation is
            positive or negative. In this case, one can use simple relations as depicted by the
            tables below.
          </p>

          <div class="w3-row">
            <div class="w3-container w3-half">
              <h4> \(X \rightarrow Y \), a node \(X\) activating a node \(Y\):</h4>
              <table class="w3-table-all w3-centered w3-bordered w3-hoverable" style="width:70%; table-layout: fixed">
                <thead>
                  <tr class="w3-grey">
                    <th>\(X\)</th>
                    <th>\(f_Y(X)\)</th>
                  </tr>
                </thead>
                <tr>
                  <td>0</td>
                  <td>0</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>2</td>
                </tr>
              </table>
            </div>
            <div class="w3-container w3-half">
              <h4> \(X \dashv Y \), a node \(X\) inhibiting a node \(Y\): </h4>
              <table class="w3-table-all w3-centered w3-bordered w3-hoverable" style="width:70%; table-layout: fixed">
                <thead>
                  <tr class="w3-grey">
                    <th>\(X\)</th>
                    <th>\(f_Y(X)\)</th>
                  </tr>
                </thead>
                <tr>
                  <td>0</td>
                  <td>2</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>0</td>
                </tr>
              </table>
            </div>
          </div>
          
          <p class="line_space">
            Local activation functions depicting these tables are then:
          </p>
          <div class="w3-row w3-center w3-mobile">
            <div class="w3-container w3-half">
              activation: \(f_Y(X) = X\),
            </div>
            <div class="w3-container w3-half">
              inhibition: \(f_Y(X) = 2-X \)
            </div>
          </div>
          <p class="line_space">
            Since \(-1 \bmod 3 = 2\), then the equation for inhibition can also be written as
            \(f_Y(X) = 2+2X\). Note that the table for inhibition just reverses the values and so
            can be considered as an analog of the Boolean NOT gate. The user may then write the
            local activation function for inhibition in several ways, including algebraic forms as
            well as using the included <tt>not</tt> function.
          </p>
          
          <center>
            <div class="w3-cell-row" style="width: 75%">
              <div class="w3-panel w3-mobile w3-border w3-light-grey w3-leftbar"
                   style="text-align: left">
                <h5> <i> SteadyCellPhenotype</i> activation syntax: </h5>
                <center>
                  <tt>Y = X</tt>
                </center>
              </div>
            </div>
          </center>

          <center>
            <div class="w3-cell-row" style="width: 75%">
              <div class="w3-panel w3-mobile w3-border w3-light-grey w3-leftbar"
                   style="text-align: left">
                <h5> <i>SteadyCellPhenotype</i> inhibition syntax: </h5>
                <div style="text-align: center">
                  <div style="display: inline-block; text-align: left">
                    <tt>
                      Y = not(X) <br>
                      Y = 2+2*X <br>
                      Y = 2-X
                    </tt>          
                  </div>
                </div>
              </div>
            </div>
          </center>
          
          <p class="line_space">
            When a node has two inputs (e.g., TfR1, Fpn and Ft in Figure 1) then local activation
            functions may also be defined using the <tt>max</tt> or <tt>min</tt> operators (see
            Tables below).
          </p>
          
          <div class="w3-row">
            <div class="w3-container w3-half">
              <h4> \(f_Z(X,Y) = \max(X,Y)\):</h4>
              <table class="w3-table-all w3-centered w3-bordered w3-hoverable" style="width:70%; table-layout: fixed">
                <thead>
                  <tr class="w3-grey">
                    <th>\(X\)</th>
                    <th>\(Y\)</th>
                    <th>\(f_Z(X,Y)\)</th>
                  </tr>
                </thead>
                <tr>
                  <td>0</td>
                  <td>0</td>
                  <td>0</td>
                  
                </tr>
                <tr>
                  <td>0</td>
                  <td>1</td>
                  <td>1</td>
                  
                </tr>
                <tr>
                  <td>0</td>
                  <td>2</td>
                  <td>2</td>
                  
                </tr>
                <tr>
                  <td>1</td>
                  <td>0</td>
                  <td>1</td>
                  
                </tr>
                <tr>
                  <td>1</td>
                  <td>1</td>
                  <td>1</td>
                  
                </tr>
                <tr>
                  <td>1</td>
                  <td>2</td>
                  <td>2</td>
                  
                </tr>
                <tr>
                  <td>2</td>
                  <td>0</td>
                  <td>2</td>
                  
                </tr>
                <tr>
                  <td>2</td>
                  <td>1</td>
                  <td>2</td>
                  
                </tr>
                <tr>
                  <td>2</td>
                  <td>2</td>
                  <td>2</td>
                  
                </tr>
              </table>
            </div>
            <div class="w3-container w3-half">
              <h4> \(f_Z(X,Y) = \min(X,Y)\): </h4>
              <table class="w3-table-all w3-centered w3-bordered w3-hoverable" style="width:70%; table-layout: fixed">
                <thead>
                  <tr class="w3-grey">
                    <th>\(X\)</th>
                    <th>\(Y\)</th>
                    <th>\(f_Z(X,Y)\)</th>
                  </tr>
                </thead>
                <tr>
                  <td>0</td>
                  <td>0</td>
                  <td>0</td>
                  
                </tr>
                <tr>
                  <td>0</td>
                  <td>1</td>
                  <td>0</td>
                  
                </tr>
                <tr>
                  <td>0</td>
                  <td>2</td>
                  <td>0</td>
                  
                </tr>
                <tr>
                  <td>1</td>
                  <td>0</td>
                  <td>0</td>
                  
                </tr>
                <tr>
                  <td>1</td>
                  <td>1</td>
                  <td>1</td>
                  
                </tr>
                <tr>
                  <td>1</td>
                  <td>2</td>
                  <td>1</td>
                  
                </tr>
                <tr>
                  <td>2</td>
                  <td>0</td>
                  <td>0</td>
                  
                </tr>
                <tr>
                  <td>2</td>
                  <td>1</td>
                  <td>1</td>
                  
                </tr>
                <tr>
                  <td>2</td>
                  <td>2</td>
                  <td>2</td>
                  
                </tr>
              </table>
            </div>
          </div>

          <p class="line_space">
            Note that <i>SteadyCellPhenotype</i>'s <tt>max</tt> and <tt>min</tt> operators support
            two or <i>more</i> arguments. One can also combine operators, using the <tt>not</tt>
            operator inside the <tt>max</tt> and <tt>min</tt>. For example, if X activates node Z
            but Y inhibits node Z then possible update rule could be
            \(f_Z(X,Y)=\min(X,\mathrm{not}(Y)))\).
          </p>
          
          <center>
            <div class="w3-cell-row" style="width: 75%">
              <div class="w3-panel w3-mobile w3-border w3-light-grey w3-leftbar"
                   style="text-align: left">
                <h5> <i>SteadyCellPhenotype</i> syntax (some possibilities): </h5>
                <div style="text-align: center">
                  <div style="display: inline-block; text-align: left">
                    <tt>
                      Z = max(X,Y) <br>
                      Z = max(X,not(Y)) <br>
                      Z = max(not(X),not(Y)) <br>
                      <br>
                      Z = min(X,Y) <br>
                      Z = min(X,not(Y)) <br>
                      Z = min(not(X),not(Y)) <br>
                    </tt>
                  </div>
                </div>
              </div>
            </div>
          </center>

          <p class="line_space">
            If nontraditional activation, inhibition, or any other modulation is required, then the
            user may enter any combination of algebraic or max/min/not expressions
            and <i>SteadyCellPhenotype</i> will evaluate the corresponding function modulo 3.
          </p>
          
          <center>
            <div class="w3-cell-row" style="width: 75%">
              <div class="w3-panel w3-mobile w3-border w3-light-grey w3-leftbar"
                   style="text-align: left">
                <h5> <i>SteadyCellPhenotype</i> syntax (some possibilities): </h5>
                <div style="text-align: center">
                  <div style="display: inline-block; text-align: left">
                    <tt>
                      Y = 2*X+X^2 <br>
                      Y = 2+X^2 <br>
                      <br>
                      Z = X+Y^2+2*X^2*Y^2 <br>
                      Z = max(2+X^2, Y*(1+Y)) 
                    </tt>
                  </div>
                </div>
              </div>
            </div>
          </center>

          
          <p class="line_space">
            For nodes with more than two inputs, any composition of the <tt>max</tt>, <tt>min</tt>,
            and <tt>not</tt> operators are possible. The <tt>not</tt> operator will always take a
            single expression as input and the <tt>max</tt> and <tt>min</tt> operators take two or
            more comma delimited arguments. Similar to the cases above, other expressions can be
            used as well among input nodes. Internally, <tt>max</tt> and <tt>min</tt> operators are
            recoded as polynomials of degree four when necessary for algebraic computations:
            
            <div class="w3-row w3-center w3-mobile">
              <div class="w3-container w3-half">
                \(\max(x,y) = x^2y^2+x^2y+xy^2+2xy+x+y\),
              </div>
              <div class="w3-container w3-half">
                \(\min(x,y)=2x^2y^2+2x^2y+2xy^2+xy \)
              </div>
            </div>
          </p>
          
          <p class="line_space">
            <b> Note: </b> <i>Unlike</i> variable names, the names of the <tt>max</tt>, <tt>min</tt>
            and <tt>not</tt> operators are case insensitive and either lower case, all caps, or a
            combination of cases can be used to enter these functions.
          </p>
          
          <!--  ACK: WE SHOULD SAY SOMETHING ABOUT CASES FOR VARIABLES.
                JC: here is my attempt: second box -->

          <center>
            <div class="w3-cell-row" style="width: 75%">
              <div class="w3-panel w3-mobile w3-border w3-light-grey w3-leftbar"
                   style="text-align: left">
                <h5> <i>SteadyCellPhenotype</i> syntax for lower case, all caps, and a combination (some possibilities): </h5>
                <div style="text-align: center">
                  <div style="display: inline-block; text-align: left">
                    <tt>
                      max(X,Y) <br>
                      Max(X,not(Y)) <br>
                      mAx(not(X),noT(Y)) <br>
                      min(X,Y) <br>
                      MIN(X,NOT(Y))<br>
                    </tt>
                  </div>
                </div>
              </div>
            </div>
          </center>
          
          <center>
            <div class="w3-cell-row" style="width: 75%">
              <div class="w3-panel w3-mobile w3-border w3-light-grey w3-leftbar"
                   style="text-align: left">
                <h5> <i>SteadyCellPhenotype</i> syntax for variable names. Once a variable name is
                    assigned (e.g., <b>LIP</b>) then exactly the same expression must be used for
                    all update functions:
                </h5>
                <div style="text-align: center">
                  <div style="display: inline-block; text-align: left">
                    <tt>
                        LIP = min(TfR1, min(not(Fpn),not(Ft))) <br>
                        IRP1 = not(LIP) <br>
                    </tt>
                  </div>
                </div>
              </div>
            </div>
          </center>
          
          <h3> Example: iron homeostasis pathway </h3>
          <p class="line_space">
            Using the graph in Figure 1 and rules as described in
            <cite><a href="https://doi.org/10.1371/journal.pcbi.1005352">doi:10.1371/journal.pcbi.1005352</a></cite>
            we can write local activation functions for this portion of the network. Note that IRP1
            has an adjusted rule (see discussion on pages 16-17 of the article mentioned
            above). Syntax and the actual entry within an application (Figure 2) are shown
            below. Note, user also has an option to upload the file in text (.txt) format.
          </p>
          <center>
            <div class="w3-cell-row" style="width: 75%">
              <div class="w3-panel w3-mobile w3-border w3-light-grey w3-leftbar"
                   style="text-align: left">
                <h5> <i>SteadyCellPhenotype</i> syntax: </h5>
                <div style="text-align: center">
                  <div style="display: inline-block; text-align: left">
                    <tt>
                      LIP = min(TfR1, min(not(Fpn),not(Ft))) <br>
                      TfR1 = max(IRP1^2, IRP2) <br>
                      Fpn = min(2+2*IRP1^2, not(IRP2)) <br>
                      Ft = min(2+2*IRP1^2, not(IRP2)) <br>
                      IRP1 = not(LIP) <br>
                      IRP2 = not(LIP) <br>
                    </tt>
                  </div>
                </div>
              </div>
            </div>
          </center>
          
          <center>
            <figure>
              <img src="images/model_entry.png" style="max-width: 90%;"/>
              <figcaption>
                <b>Figure 2 - Model entry window.</b> User can enter the model directly in the provided window, or
                choose a text file and then upload the file into the same window. Once model is entered, user may select
                <b>Set Model Options</b> button that will take the user to the window similar in Figure 3 below.
              </figcaption>
            </figure>
          </center>
          
        </section>
        
        <section>
          <h3> Continuity </h3>
          <p class="line_space">
            In Boolean networks there is a single scale of change for each node. However, in ternary
            networks there are two possible scales: a jump \(\pm1\) or \(\pm 2\). This means that a
            node can have a "discontinuous" change, for example from low (0) to high (2), in a
            single time step. If user wishes to ensure that all or some nodes change by at most one
            unit then one can select an option <span class="w3-tag w3-round
            w3-us-blue">Continuous</span> for the variables (see Figure 3).
            
            Internally continuity is applied to each update rule as follows:
            <ul>
              <li>
                the local activation function \(f_X\) is computed for the variable \(X\) and
                compared to the current state of the variable,
              </li>
              <li>
                if the current state of \(X\) is the same as \(f_X\) or differs from \(f_X\) by one
                unit only, then the value assigned to the variable is \(f_X\), and
              </li>
              <li>
                if the current state of \(X\) and \(f_X\) differs by \(\pm2\), then the value of
                \(X\) at the next time step moves by 1 in the direction of \(f_X\).
              </li>
            </ul>
          </p>
          
          <center>
            <figure>
              <img src="images/continuity_selection.png" style="max-width: 90%;"/>
              <figcaption>
                <b>Figure 3 - Continuity selection.</b> The user can selected all or some variables
                to be continuous. In this figure only <tt>TfR1</tt>, <tt>Fpn</tt>, and <tt>Ft</tt>
                are selected. The remaining variables may undergo \(\pm2\) jumps.
              </figcaption>
            </figure>
          </center>
          
        </section>
        
        <section>
          <h3> State Space: attractors </h3>
          <p class="line_space">
            In the current version of <i>SteadyCellPhenotype</i>, all nodes in the network are on
            a <i>synchronous</i> update schedule, where all values are updated simultaneously. This
            implies that trajectories are deterministic and so each state of the network will belong
            to the basin of attraction of only one attractor: a fixed point or cyclic attractor.
          </p>
          
          <p class="line_space">
            <b>Fixed Points</b> can be computed using two different options.
            <ul>
              <li> Selecting the radio-button <span class="w3-tag w3-round w3-us-blue">Find all
                fixed points</span> (see Figure 3).  In this case <i>SteadyCellPhenotype</i> will
                compute all fixed points analytically using
                <cite><a href="http://www2.macaulay2.com/Macaulay2/">Macaulay2</a></cite>, which can be downloaded
                <cite><a href="http://www2.macaulay2.com/Macaulay2/Downloads/">here</a></cite>.
                Note that option to find all fixed points will only work after the user installs
                Macaulay2. If the model has no fixed points then <i>Error in input</i> with the text
                <tt>Error running Macaulay2!</tt> will be displayed.
                
                <!--    ACK: WAIT IS THAT TRUE? THAT IS AN ERROR!!!
                        JC: I thought you did this deliberately. Here is the model (below) see for
                            yourself what happens. I guess, in case there are no fixed points, then
                            we should display something useful.
                
                x1 = min(x2,x3)
                x2 = 2*x3+x3^2
                x3 = 2+x1^2
                
                -->
              </li>
              <li> Another option to find <i>some</i> of the fixed points is by selecting the
              radio-button <span class="w3-tag w3-round w3-us-blue">Sample fixed points and
              cycles</span>. Here the user can selects from the dropdown list the number of random
              initial states from which the trajectory will be computed.
              </li>
            </ul>
            <b>Cyclic attractors</b> can be computed by selecting the
              radio-button <span class="w3-tag w3-round w3-us-blue">Sample fixed points and
              cycles</span> and the number of initial random states. <i>If the number of samples
              from the dropdown list is larger than the state space (only possible for relatively
              small models), then a complete state space search will be performed.</i>
          </p>
          
          <p class="line_space">
            When the radio-button
            <span class="w3-tag w3-round w3-us-blue">Sample fixed points and cycles</span> is
            selected, a length of each trajectory leading to an attractor for each random start is
            recorded. A histogram, summarizing a distribution of the lengths of paths, is displayed
            below each attractor (see Figure 4). Attractors can be saved in a tab-separated format.
            All images also have save button options.
          
          <center>
            <figure>
              <img src="images/length_of_path.png" style="max-width: 90%;"/>
              <figcaption>
                <b>Figure 4 - Path length.</b> A cyclic attractor of length 6 for the model in Figure 1.
                Since the size of the model is small, complete state space search was performed. Numbers
                below the attractor (48.8% and Count 356) indicate how many states out of \(3^6 = 729\)
                belong to the basin of this attractor.
              </figcaption>
            </figure>
          </center>
          
          <p class="line_space">
          Additionally, user can select the
          <span class="w3-tag w3-round w3-us-blue">Visualize</span> option for all or some of the
          variables (one can see this option in Figure 3). When this option is selected
          then <i>SteadyCellPhenotype</i> will collect additional statistics. In particular, for
          each random starting state a trajectory (path) is recorded. The collection of all these
          trajectories are then aligned <i>on the right</i> to ensure that they all arrive at the
          same time at the fixed point or at a specified point on their cyclic attractor. The image
          in Figure 5 displays the mean value and standard deviation of the variable states along
          these trajectories. This feature is useful in demonstrating, for example, if biological
          species of interest (LIP) had a cyclic behavior before entering a fixed point.
          </p>
          
          <center>
            <figure>
              <img src="images/phased_envelope.png" style="max-width: 90%;"/>
              <figcaption>
                <b>Figure 5 - Phased Envelope.</b> These images were generated using the entire
                model (24 nodes) from <cite><a href="https://doi.org/10.1371/journal.pcbi.1005352">
                doi:10.1371/journal.pcbi.1005352
                </a></cite>
              </figcaption>
            </figure>
          </center>
        
          </p>
        </section>
        
        <section>
          <h3> Tracing a Specific State </h3>
          
          <p class="line_space">
            <i>SteadyCellPhenotype</i> offers an option to trace a specific state by selecting
            <b>Trace state(s)</b> radio button. This allows a user to investigate the evolution of interesting
            states and visualize trajectories via a graph. Under the
            <span class="w3-tag w3-round w3-us-blue">Initial State</span> option user can choose
            from the dropdown list values <tt> 0, 1, 2, or *</tt> (see Figure 6).
            The symbol asterisk (*) means that all states for this particular species will be considered.
            If user would like to investigate nearby states around a specific point of interest, then checking
            the box <b>Include nearby states</b> will include evolution of trajectories from states that are
            the Hamming distance one from the specified point, i.e., all states that differ from the
            specified state by one unit for exactly one species.
            
            <i>SteadyCellPhenotype</i> will display a heatmap that records evolution of trajectories and a
            directed graph summarizing these paths (see Figure 7). Option to save the graph and the heatmap
            are available. The values in the heatmap will be saved in a tab-separated format.
          </p>
          
          
          <center>
              <figure>
                  <img src="images/trace-state-config2.png" style="max-width: 90%;"/>
                  <figcaption>
                      <b>Figure 6 - Trace state(s).</b> States with varying TfR1 will be traced and nearby
                      stets will be included as well. The output of the selection is shown in Figure 7 below.
                      Notice no continuity was selected.
                  </figcaption>
              </figure>
          </center>
          
          <center>
              <figure>
          <div class="w3-row">
            <div class="w3-col m6 l6">
              <img src="images/trace-state-table.png" style="max-width: 90%;"/>
            </div>
            <div class="w3-col m6 l6">
              <svg viewBox="-100,-105.85126049662398,204.77840104913082,200" xoverflow="visible" width="100%" style="max-width: 90%; height: 50vh;"><defs><marker id="arrow" viewBox="0 0 10 10" refX="15" refY="5" orient="auto-start-reverse" markerWidth="6" markerHeight="6" xoverflow="visible"><path d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs><g stroke="#666" stroke-opacity="0.9"><line stroke-width="1.5" marker-end="url(#arrow)" x1="-87.69228707352686" y1="25.25855759646455" x2="-54.81447164327336" y2="21.732575318097943"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-89.92733573096147" y1="-40.626218700084756" x2="-70.07309147289409" y2="-65.09645599365662"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="54.926052351768654" y1="-5.195405528448257" x2="57.23574042259611" y2="-38.84783053287181"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="26.684766434760117" y1="-37.24033220422636" x2="57.23574042259611" y2="-38.84783053287181"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="27.77986464554087" y1="-95.85126049662398" x2="55.37777275498098" y2="-82.02784995435589"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="26.05830702218617" y1="13.107759420201887" x2="51.93722194043763" y2="32.7012078229007"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="57.23574042259611" y1="-38.84783053287181" x2="85.15150263978266" y2="-50.714611902933406"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-36.4907988766828" y1="51.84099580191394" x2="-54.81447164327336" y2="21.732575318097943"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-48.27110573523179" y1="56.63981681555032" x2="-54.81447164327336" y2="21.732575318097943"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="85.15150263978266" y1="-50.714611902933406" x2="94.85106531816936" y2="-21.143698564687828"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-70.07309147289409" y1="-65.09645599365662" x2="-41.56600778874067" y2="-52.21925414293377"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="64.37341659024534" y1="63.82127103220012" x2="51.93722194043763" y2="32.7012078229007"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-41.56600778874067" y1="-52.21925414293377" x2="-45.026204558211596" y2="-17.964742637566165"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="39.202524137429" y1="2.944200049392543" x2="51.93722194043763" y2="32.7012078229007"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-44.471480237180884" y1="-83.0867648895863" x2="-41.56600778874067" y2="-52.21925414293377"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-34.28958169453441" y1="-3.6002081762898497" x2="-54.81447164327336" y2="21.732575318097943"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="38.657947758601935" y1="65.30044892266018" x2="51.93722194043763" y2="32.7012078229007"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="81.52721673491327" y1="19.623276506529898" x2="51.93722194043763" y2="32.7012078229007"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-61.501982138875036" y1="-9.469317131088046" x2="-54.81447164327336" y2="21.732575318097943"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-60.11832691239644" y1="56.10890299028941" x2="-54.81447164327336" y2="21.732575318097943"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="77.30444432869004" y1="53.33719863404905" x2="51.93722194043763" y2="32.7012078229007"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-54.81447164327336" y1="21.732575318097943" x2="-79.21999311720248" y2="-8.732087494148281"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="29.683242770134438" y1="-65.54960304899163" x2="3.8693257278841733" y2="-81.4755815621185"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-24.165062549247637" y1="9.418286704504567" x2="-54.81447164327336" y2="21.732575318097943"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-72.18517227768412" y1="50.69687792134957" x2="-54.81447164327336" y2="21.732575318097943"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-45.026204558211596" y1="-17.964742637566165" x2="-54.81447164327336" y2="21.732575318097943"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="94.85106531816936" y1="-21.143698564687828" x2="73.70356298208257" y2="3.7114156982490316"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="19.819701329656414" y1="30.958787931829676" x2="51.93722194043763" y2="32.7012078229007"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="51.93722194043763" y1="32.7012078229007" x2="54.926052351768654" y2="-5.195405528448257"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="28.48252102063174" y1="59.05513734715239" x2="51.93722194043763" y2="32.7012078229007"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-3.798154472724002" y1="-51.33796591240542" x2="3.8693257278841733" y2="-81.4755815621185"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="73.70356298208257" y1="3.7114156982490316" x2="51.93722194043763" y2="32.7012078229007"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-82.07020072703682" y1="40.96936836483622" x2="-54.81447164327336" y2="21.732575318097943"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-22.608114573500192" y1="26.574444473063284" x2="-54.81447164327336" y2="21.732575318097943"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-85.09738650331056" y1="9.093268187257591" x2="-54.81447164327336" y2="21.732575318097943"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-79.21999311720248" y1="-8.732087494148281" x2="-89.92733573096147" y2="-40.626218700084756"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="3.8693257278841733" y1="-81.4755815621185" x2="-3.798154472724002" y2="-51.33796591240542"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="21.401341761618763" y1="47.22756470960752" x2="51.93722194043763" y2="32.7012078229007"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-22.444748724806185" y1="-76.37485909685165" x2="-41.56600778874067" y2="-52.21925414293377"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="51.34312112193908" y1="67.0826622905518" x2="51.93722194043763" y2="32.7012078229007"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="-27.686009720509183" y1="42.064431363808964" x2="-54.81447164327336" y2="21.732575318097943"></line><line stroke-width="1.5" marker-end="url(#arrow)" x1="84.14848259741477" y1="37.23745534446073" x2="51.93722194043763" y2="32.7012078229007"></line></g><g stroke="#fff" stroke-width="1.5"><circle r="5" fill="#f28e2c" cx="-60.11832691239644" cy="56.10890299028941"><title>0</title></circle><circle r="5" fill="#e15759" cx="-54.81447164327336" cy="21.732575318097943"><title>1</title></circle><circle r="5" fill="#e15759" cx="-79.21999311720248" cy="-8.732087494148281"><title>2</title></circle><circle r="5" fill="#e15759" cx="-89.92733573096147" cy="-40.626218700084756"><title>3</title></circle><circle r="5" fill="#e15759" cx="-70.07309147289409" cy="-65.09645599365662"><title>4</title></circle><circle r="5" fill="#e15759" cx="-41.56600778874067" cy="-52.21925414293377"><title>5</title></circle><circle r="5" fill="#e15759" cx="-45.026204558211596" cy="-17.964742637566165"><title>6</title></circle><circle r="5" fill="#f28e2c" cx="-36.4907988766828" cy="51.84099580191394"><title>7</title></circle><circle r="5" fill="#f28e2c" cx="-82.07020072703682" cy="40.96936836483622"><title>8</title></circle><circle r="5" fill="#f28e2c" cx="-34.28958169453441" cy="-3.6002081762898497"><title>9</title></circle><circle r="5" fill="#f28e2c" cx="29.683242770134438" cy="-65.54960304899163"><title>10</title></circle><circle r="5" fill="#e15759" cx="3.8693257278841733" cy="-81.4755815621185"><title>11</title></circle><circle r="5" fill="#e15759" cx="-3.798154472724002" cy="-51.33796591240542"><title>12</title></circle><circle r="5" fill="#f28e2c" cx="-24.165062549247637" cy="9.418286704504567"><title>13</title></circle><circle r="5" fill="#f28e2c" cx="38.657947758601935" cy="65.30044892266018"><title>14</title></circle><circle r="5" fill="#e15759" cx="51.93722194043763" cy="32.7012078229007"><title>15</title></circle><circle r="5" fill="#e15759" cx="54.926052351768654" cy="-5.195405528448257"><title>16</title></circle><circle r="5" fill="#e15759" cx="57.23574042259611" cy="-38.84783053287181"><title>17</title></circle><circle r="5" fill="#e15759" cx="85.15150263978266" cy="-50.714611902933406"><title>18</title></circle><circle r="5" fill="#e15759" cx="94.85106531816936" cy="-21.143698564687828"><title>19</title></circle><circle r="5" fill="#e15759" cx="73.70356298208257" cy="3.7114156982490316"><title>20</title></circle><circle r="5" fill="#f28e2c" cx="-27.686009720509183" cy="42.064431363808964"><title>21</title></circle><circle r="5" fill="#f28e2c" cx="26.684766434760117" cy="-37.24033220422636"><title>22</title></circle><circle r="5" fill="#f28e2c" cx="39.202524137429" cy="2.944200049392543"><title>23</title></circle><circle r="5" fill="#f28e2c" cx="-72.18517227768412" cy="50.69687792134957"><title>24</title></circle><circle r="5" fill="#f28e2c" cx="19.819701329656414" cy="30.958787931829676"><title>25</title></circle><circle r="5" fill="#f28e2c" cx="84.14848259741477" cy="37.23745534446073"><title>26</title></circle><circle r="5" fill="#f28e2c" cx="77.30444432869004" cy="53.33719863404905"><title>27</title></circle><circle r="5" fill="#f28e2c" cx="-44.471480237180884" cy="-83.0867648895863"><title>28</title></circle><circle r="5" fill="#f28e2c" cx="28.48252102063174" cy="59.05513734715239"><title>29</title></circle><circle r="5" fill="#f28e2c" cx="-22.608114573500192" cy="26.574444473063284"><title>30</title></circle><circle r="5" fill="#f28e2c" cx="27.77986464554087" cy="-95.85126049662398"><title>31</title></circle><circle r="5" fill="#e15759" cx="55.37777275498098" cy="-82.02784995435589"><title>32</title></circle><circle r="5" fill="#f28e2c" cx="21.401341761618763" cy="47.22756470960752"><title>33</title></circle><circle r="5" fill="#f28e2c" cx="-87.69228707352686" cy="25.25855759646455"><title>34</title></circle><circle r="5" fill="#f28e2c" cx="51.34312112193908" cy="67.0826622905518"><title>35</title></circle><circle r="5" fill="#f28e2c" cx="81.52721673491327" cy="19.623276506529898"><title>36</title></circle><circle r="5" fill="#f28e2c" cx="26.05830702218617" cy="13.107759420201887"><title>37</title></circle><circle r="5" fill="#f28e2c" cx="-22.444748724806185" cy="-76.37485909685165"><title>38</title></circle><circle r="5" fill="#f28e2c" cx="64.37341659024534" cy="63.82127103220012"><title>39</title></circle><circle r="5" fill="#f28e2c" cx="-48.27110573523179" cy="56.63981681555032"><title>40</title></circle><circle r="5" fill="#f28e2c" cx="-85.09738650331056" cy="9.093268187257591"><title>41</title></circle><circle r="5" fill="#f28e2c" cx="-61.501982138875036" cy="-9.469317131088046"><title>42</title></circle></g></svg>
            </div>
          </div>
          <caption>
              <b>Figure 7:</b> Heatmaps (left image - partial output) displaying evolution of trajectories
              from a specified state. States are numbered and correspond to circles of the digraph (right image).
              Attractors are depicted by red circles.
          </caption>
          </figure>
          </center>
          
          <p class="line_space">
          <b>Note:</b> for small models selecting asterisk (*) for all species
              will result in the computation of the entire state space. Using this option for large
              models is not advisable. Complete state space for our running example is displayed
              in Figure 8 below.
          </p>
          <center>
              <figure>
                  <img src="images/iron_core_state_space_cont.pdf" style="max-width: 100%;"/>
                  <figcaption>
                      <b>Figure 8: </b> Complete state space of iron model in Figure 1. Option
                      "continuous" was selected for all species except LIP (see <cite><a href="https://doi.org/10.1371/journal.pcbi.1005352">
                          doi:10.1371/journal.pcbi.1005352
                          </a></cite> for explanations). Red circles are attractors.
                      Model has one fixed point
                      and two cyclic attractors of length 6.
                      <!-- - JC: red circles are barely visible and bland in too mach with orange.
                      I think we should consider different colors or larger red circles.
                      Sorry, I am still pushing that because for large graphs it is hard to see attractors. -->
                  </figcaption>
              </figure>
          </center>
        </section>
        
        <section>
          <h3> Knockout and Overexpression Experiments </h3>
          <p class="line_space">
          
          </p>
        </section>
      </article>
      <!--- Documentation portion END --->
      
      
    </div>
    <footer class="w3-container w3-us-red w3-margin-top">
      <h5>Copyright 2019-2021, Supported by CAS Mellon Fund, American University</h5>
    </footer>
  </body>
</html>
